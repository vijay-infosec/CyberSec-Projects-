# ProcMon & Macro Malware Analysis (FLARE VM â€“ Air-Gapped)

This lab analyzes a malicious macro-enabled document in an offline FLARE VM environment using ProcMon, ProcWatch, and olevba.  
The focus is on local behavior, process activity, and macro extraction since the VM is air-gapped with **no Internet access**.

---

## ğŸ” Objectives
- Monitor malware execution with ProcMon and ProcWatch  
- Identify dropped files and spawned processes  
- Extract and analyze VBA macros with olevba  
- Recognize obfuscation and macro execution techniques  
- Perform safe malware analysis in a fully offline environment  

---

## ğŸ§ª Dynamic Analysis (ProcMon / ProcWatch)

### Key Findings
- Opening the document creates a hidden copy (`emotet.doc`)  
- Clicking **Enable Editing** triggers:  
  - `powershell.exe`  
  - `conhost.exe`  
- Behavior consistent with macro-based dropper malware

### Network Activity  
No network events were recorded.  
This is expected because FLARE VM is **air-gapped**, preventing any C2 communication.

---

## ğŸ§¬ Static Macro Analysis (olevba)

Macros were extracted using:

malware-analysis-procmon/
â”‚â”€â”€ README.md
â””â”€â”€ screenshots/
â”œâ”€â”€ dirwatch_process_activity.png
â”œâ”€â”€ procmon_file_writes.png
â””â”€â”€ office_macro_indicators.png


---

## âœ… Outcome
This lab demonstrates:
- Safe handling of malware in an offline environment  
- Ability to trace execution flow through system monitors  
- Extraction and interpretation of malicious macros  
- Understanding of early-stage macro malware behavior  

Suitable for SOC, DFIR, and malware analysis portfolios.
