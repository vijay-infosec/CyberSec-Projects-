# ANY.RUN Malware Analysis â€“ Suspicious MSI â†’ EXE Execution Chain

This analysis examines a suspicious ZIP archive containing an MSI installer that launches a multi-stage payload. The malware exhibits process chaining, PowerShell abuse, network communication, and ATT&CK-aligned behavior consistent with commodity stealers such as RedLine/Mikey variants.

---

## ğŸ” Summary
- Verdict: **Malicious Activity (100/100)**  
- Multi-stage execution involving MSI â†’ msiexec.exe â†’ crypted.exe â†’ AppLaunch.exe  
- PowerShell used with evasion flags and non-standard execution behavior  
- Outbound network requests observed  
- MITRE ATT&CK mapping shows **5 tactics, 10 techniques**  
- VirusTotal relations confirm IP is linked to multiple malicious binaries  

---

## ğŸ§ª Process Tree Analysis

Key observations:

- `aipackagechainer.exe` triggers additional executables  
- `crypted.exe` runs as a secondary payload  
- `AppLaunch.exe` flagged with **100/100 malicious score**  
- Multiple msiexec.exe instances involved in unpacking/embedding behavior  

ğŸ“¸ **process_tree.png**

---

## ğŸŒ Network Activity

The sandbox captured several outbound HTTP requests:

- Processes making requests:
  - `svchost.exe`
  - `backgroundTaskHost.exe`
  - `SIHClient.exe`
  - `powershell.exe`
- Several GET requests return **200 OK**
- Traffic includes OCSP lookups, Microsoft CRL requests, and other telemetry

ANY.RUN also reports **non-standard port usage** in PowerShell execution.

ğŸ“¸ **network_http.png**

---

## âš ï¸ PowerShell Execution & Anti-Forensics

ANY.RUN flagged `AppLaunch.exe` for:

- `-ExecutionPolicy RemoteSigned`
- `-NoLogo`, `-NoProfile`
- Suspicious cleanup behavior (indicator removal)

This aligns with ATT&CK techniques for:

- **T1059.001 â€“ PowerShell**
- **T1070 â€“ Indicator Removal**

ğŸ“¸ **powershell_details.png**

---

## ğŸ”— VirusTotal Intelligence â€“ Infrastructure Reuse

The IP address **171.22.28.236** is associated with multiple malicious executables.

VirusTotal Relations tab shows:

- Over 30 communicating malicious samples  
- Several EXE files with high vendor detections  
- Includes file names consistent with stealer activity  

ğŸ“¸ **vt_relations.png**

---

## ğŸ›¡ MITRE ATT&CK Techniques Observed

ANY.RUN mapped:

### **Execution**
- T1059 â€“ Command Execution  
- T1059.001 â€“ PowerShell  
- T1204 â€“ User Execution  

### **Defense Evasion**
- T1553 â€“ Subvert Trust Controls  
- T1027 â€“ Obfuscated / Packed Files  

### **Discovery**
- T1082 â€“ System Information Discovery  
- T1083 â€“ File and Directory Discovery  
- Query Registry  

### **Command & Control**
- T1571 â€“ Non-Standard Port  

### **Impact**
- Inhibit System Recovery  

ğŸ“¸ **mitre_matrix.png**

---

## ğŸ“ Repository Structure

anyrun-analysis/
â”‚â”€â”€ README.md
â””â”€â”€ screenshots/
â”œâ”€â”€ process_tree.png
â”œâ”€â”€ powershell_details.png
â”œâ”€â”€ network_http.png
â”œâ”€â”€ vt_relations.png
â””â”€â”€ mitre_matrix.png


---

## ğŸ›  Tools Used
- ANY.RUN interactive sandbox  
- VirusTotal Relations  
- MITRE ATT&CK Navigator  

---

## âœ… Outcome

This analysis demonstrates capability in:

- Interactive sandbox investigation  
- Process tree interpretation  
- Network behavior correlation  
- ATT&CK technique mapping  
- Threat classification using OSINT (VT, ANY.RUN)  
- Extracting indicators and recognizing staged execution chains  

Suitable for SOC, DFIR, and Malware Analysis portfolios.

